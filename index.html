<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Stock Portfolio Manager | 損益管理アプリ</title>
    <meta name="description" content="保有銘柄の評価額、損益、損益率を簡単に管理・可視化できるWebアプリです。">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style-new.css">
    <link rel="icon" type="image/svg+xml"
        href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Cdefs%3E%3ClinearGradient id='g' x1='0%25' y1='0%25' x2='100%25' y2='100%25'%3E%3Cstop offset='0%25' style='stop-color:%236366f1;stop-opacity:1' /%3E%3Cstop offset='100%25' style='stop-color:%2310b981;stop-opacity:1' /%3E%3C/linearGradient%3E%3C/defs%3E%3Crect width='100' height='100' rx='22' fill='url(%23g)' /%3E%3Cpath d='M25 70 l15-15 l10 10 l25-30 l10 5' fill='none' stroke='white' stroke-width='8' stroke-linecap='round' stroke-linejoin='round'/%3E%3Cpath d='M65 30 h15 v15' fill='none' stroke='white' stroke-width='8' stroke-linecap='round' stroke-linejoin='round'/%3E%3C/svg%3E">
</head>

<body>
    <div class="container">
        <header>
            <div class="header-main">
                <div class="header-info" style="flex: 1;">
                    <div style="display: flex; align-items: center; gap: 0.8rem;">
                        <h1>Stock Portfolio Manager(Scraping JSON-LD/Meta Tags)</h1>
                        <button id="featured-settings-btn" class="btn-featured-edit"
                            style="opacity: 1; width: 28px; height: 28px;" title="自動表示設定">⚙️</button>
                    </div>
                    <!-- Featured Stocks Section -->
                    <div class="featured-section"
                        style="margin-top: 1.5rem; display: flex; align-items: stretch; gap: 1rem;">
                        <div id="featured-stocks-list" class="featured-grid" style="flex: 1;">
                            <!-- NY Dow -->
                            <div class="featured-card" id="featured-dji">
                                <div style="display: flex; justify-content: space-between; align-items: flex-start;">
                                    <div class="featured-label" id="dji-label">NYダウ</div>
                                    <button class="btn-featured-edit" onclick="editFeaturedStock('dji')">✏️</button>
                                </div>
                                <div id="dji-price" class="featured-price">$--,---.--</div>
                                <div id="dji-change" class="featured-change">-- (--%)</div>
                            </div>
                            <!-- Nasdaq -->
                            <div class="featured-card" id="featured-nasdaq">
                                <div style="display: flex; justify-content: space-between; align-items: flex-start;">
                                    <div class="featured-label" id="nasdaq-label">Nasdaq</div>
                                    <button class="btn-featured-edit" onclick="editFeaturedStock('nasdaq')">✏️</button>
                                </div>
                                <div id="nasdaq-price" class="featured-price">--,---.--</div>
                                <div id="nasdaq-change" class="featured-change">-- (--%)</div>
                            </div>
                            <!-- S&P 500 -->
                            <div class="featured-card" id="featured-sp500">
                                <div style="display: flex; justify-content: space-between; align-items: flex-start;">
                                    <div class="featured-label" id="sp500-label">S&P 500</div>
                                    <button class="btn-featured-edit" onclick="editFeaturedStock('sp500')">✏️</button>
                                </div>
                                <div id="sp500-price" class="featured-price">-,---.--</div>
                                <div id="sp500-change" class="featured-change">-- (--%)</div>
                            </div>
                        </div>

                        <!-- Header Actions (Integrated) -->
                        <div class="header-actions"
                            style="display: flex; flex-direction: column; justify-content: center; align-items: center; gap: 0.5rem; padding: 0.5rem; background: var(--glass); border: 1px solid var(--border); border-radius: 1rem; min-width: 120px;">
                            <div style="display: flex; align-items: center; gap: 0.5rem;">
                                <select id="update-interval"
                                    style="background: transparent; border: 1px solid var(--border); color: var(--text-muted); padding: 0.2rem 0.3rem; border-radius: 0.4rem; font-size: 0.65rem; cursor: pointer; outline: none;">
                                    <option value="0">オフ</option>
                                    <option value="1">1分</option>
                                    <option value="2" selected>2分</option>
                                    <option value="5">5分</option>
                                </select>
                                <button id="refresh-all-btn" class="btn-icon btn-edit"
                                    style="width: 32px; height: 32px;" title="情報を一括更新">
                                    <svg id="refresh-icon" xmlns="http://www.w3.org/2000/svg" width="16" height="16"
                                        viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"
                                        stroke-linecap="round" stroke-linejoin="round">
                                        <path d="M21 2v6h-6"></path>
                                        <path d="M3 12a9 9 0 0 1 15-6.7L21 8"></path>
                                        <path d="M3 22v-6h6"></path>
                                        <path d="M21 12a9 9 0 0 1-15 6.7L3 16"></path>
                                    </svg>
                                </button>
                            </div>
                            <p id="last-updated"
                                style="font-size: 0.6rem; color: var(--text-muted); margin: 0; white-space: nowrap;">
                                最終更新: --:--:--</p>
                        </div>
                    </div>
                </div>
            </div>
        </header>

        <!-- Summary Section -->
        <div class="summary-grid">
            <div class="card">
                <div class="card-label">総評価額</div>
                <div id="total-valuation" class="card-value">¥0</div>
                <div id="total-day-change" style="font-size: 0.85rem; margin-top: 0.4rem; font-weight: 600;"></div>
            </div>
            <div class="card">
                <div class="card-label">合計損益</div>
                <div id="total-profit-loss" class="card-value">¥0</div>
                <div id="total-profit-rate" style="font-size: 0.85rem; margin-top: 0.4rem; font-weight: 600;"></div>
            </div>
            <div class="card">
                <div class="card-label">日経平均</div>
                <div id="nikkei-price" class="card-value">¥--,--</div>
                <div id="nikkei-change" class="index-change">前日比：-- (--%)</div>
            </div>
            <div class="card">
                <div class="card-label">ドル/円</div>
                <div id="usdjpy-price" class="card-value">--.--</div>
                <div id="usdjpy-change" class="index-change">-- (--%)</div>
            </div>
        </div>

        <!-- Featured Settings Modal -->
        <div id="featured-settings-modal" class="modal-overlay">
            <div class="card form-modal" style="max-width: 500px;">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem;">
                    <h2 style="font-size: 1.25rem;">注目株の自動表示設定</h2>
                    <button id="featured-modal-close" class="btn-icon"
                        style="border: none; background: transparent; font-size: 1.2rem; color: var(--text-muted); cursor: pointer;">✕</button>
                </div>
                <div class="form-grid" style="grid-template-columns: 1fr;">
                    <div class="form-group">
                        <label>表示モード</label>
                        <select id="featured-mode"
                            style="background: rgba(15, 23, 42, 0.6); border: 1px solid var(--border); border-radius: 0.75rem; padding: 0.85rem; color: var(--text-main); font-size: 1rem; cursor: pointer; outline: none;">
                            <option value="manual">手動設定（固定）</option>
                            <option value="auto_volume">自動：出来高ランキング</option>
                            <option value="auto_up">自動：値上がり率ランキング</option>
                            <option value="auto_tradingValue">自動：売買代金ランキング</option>
                        </select>
                    </div>
                    <div id="featured-auto-options" style="display: none;">
                        <div class="form-group" style="margin-top: 1rem;">
                            <label>市場フィルター</label>
                            <select id="featured-filter"
                                style="background: rgba(15, 23, 42, 0.6); border: 1px solid var(--border); border-radius: 0.75rem; padding: 0.85rem; color: var(--text-main); font-size: 1rem; cursor: pointer; outline: none;">
                                <option value="all">全市場</option>
                                <option value="prime">東証プライム</option>
                                <option value="standard">東証スタンダード</option>
                                <option value="growth">東証グロース</option>
                            </select>
                        </div>
                        <div class="form-group" style="margin-top: 1rem;">
                            <label>業種フィルター</label>
                            <select id="featured-industry"
                                style="background: rgba(15, 23, 42, 0.6); border: 1px solid var(--border); border-radius: 0.75rem; padding: 0.85rem; color: var(--text-main); font-size: 1rem; cursor: pointer; outline: none;">
                                <option value="all">全業種</option>
                                <option value="3650">電気機器</option>
                                <option value="3700">輸送用機器</option>
                                <option value="5250">情報・通信業</option>
                                <option value="9050">サービス業</option>
                                <option value="6100">小売業</option>
                                <option value="7050">銀行業</option>
                                <option value="3200">化学</option>
                                <option value="3600">機械</option>
                                <option value="6050">卸売業</option>
                                <option value="3250">医薬品</option>
                                <option value="8050">不動産業</option>
                                <option value="2050">建設業</option>
                                <option value="5050">陸運業</option>
                                <option value="3050">食料品</option>
                            </select>
                        </div>
                        <div class="form-group" style="margin-top: 1rem;">
                            <label>株価の範囲 (¥)</label>
                            <div style="display: flex; align-items: center; gap: 0.5rem;">
                                <input type="number" id="featured-min-price" placeholder="下限なし"
                                    style="flex: 1; background: rgba(15, 23, 42, 0.6); border: 1px solid var(--border); border-radius: 0.75rem; padding: 0.85rem; color: var(--text-main); font-size: 1rem;">
                                <span style="color: var(--text-muted);">〜</span>
                                <input type="number" id="featured-max-price" placeholder="上限なし"
                                    style="flex: 1; background: rgba(15, 23, 42, 0.6); border: 1px solid var(--border); border-radius: 0.75rem; padding: 0.85rem; color: var(--text-main); font-size: 1rem;">
                            </div>
                        </div>
                    </div>
                    <div
                        style="margin-top: 1.2rem; padding: 0.8rem; background: rgba(250, 204, 21, 0.1); border: 1px solid var(--warning); border-radius: 0.5rem; font-size: 0.75rem; color: var(--warning);">
                        ※自動表示中は、現在のリストにある銘柄が一時的に上書きされます。手動に戻すと元の設定に戻ります。
                    </div>
                    <div style="margin-top: 1.5rem; display: flex; gap: 0.5rem;">
                        <button id="save-featured-settings" class="btn-add" style="flex: 1;">適用する</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Floating Add Stock Modal -->
        <div id="modal-overlay" class="modal-overlay">
            <div class="card form-modal">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem;">
                    <h2 id="modal-title" style="font-size: 1.25rem;">銘柄の追加</h2>
                    <button id="modal-close" class="btn-icon"
                        style="border: none; background: transparent; font-size: 1.2rem; color: var(--text-muted); cursor: pointer;">✕</button>
                </div>
                <form id="stock-form" class="form-grid">
                    <div class="form-group">
                        <label for="code">銘柄コード</label>
                        <input type="text" id="code" placeholder="例: 7203" required>
                    </div>
                    <div class="form-group">
                        <label for="name">銘柄名</label>
                        <input type="text" id="name" placeholder="例: トヨタ自動車" required>
                    </div>
                    <div class="form-group">
                        <label for="quantity">保有数量</label>
                        <input type="number" id="quantity" step="any" placeholder="0" required>
                    </div>
                    <div class="form-group">
                        <label for="purchase-price">取得単価 (¥)</label>
                        <input type="number" id="purchase-price" step="any" placeholder="0.00" required>
                    </div>
                    <div class="form-group">
                        <label for="current-price">現在価格 (¥)</label>
                        <input type="number" id="current-price" step="any" placeholder="0.00" required>
                    </div>
                    <div class="form-actions"
                        style="display: flex; gap: 0.5rem; align-items: end; grid-column: 1 / -1;">
                        <button type="submit" id="submit-btn" class="btn-add" style="flex: 1;">追加</button>
                        <button type="button" id="cancel-btn" class="btn-add"
                            style="flex: 1; display: none;">キャンセル</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Portfolio List -->
        <div class="table-container">
            <table id="portfolio-table">
                <thead>
                    <tr>
                        <th>銘柄</th>
                        <th>保有数</th>
                        <th>取得単価</th>
                        <th>現在価格</th>
                        <th>前日比</th>
                        <th>評価額</th>
                        <th>損益 (%)</th>
                        <th>操作</th>
                    </tr>
                </thead>
                <tbody id="portfolio-body">
                    <!-- JSで動的に追加 -->
                </tbody>
            </table>
        </div>
    </div>

    <!-- Floating Action Button -->
    <button id="add-stock-trigger" class="fab-button" title="銘柄を追加">
        <span>+</span>
    </button>

    <script src="app.js?v=6"></script>
</body>

</html>